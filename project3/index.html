<!DOCTYPE html>
<html lang="en"></html><head>
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</head>
<style>
body{
  color: #6F6866;
}
h1 {
    color: #788585;
    font-weight: 300;
}
h4 {
    color: #38302E;
}
.smallheader {
    color: #FFBA08;
    font-weight: bold;
}
.zoom:hover {
  transform: scale(2);
}
.smol {
  font-size: 0.7rem;
}
</style>
<body>
  <div class="container">
    <div class="row">
      <h1 class="header">CS 194-26: Project 3</h1>
      <h4>Face Morphing</h4>
      <h5>Imaani Choudhuri</h5>
    </div>
    <div class="row">
      <h6 class="smallheader">Defining Correspondences</h6>
      <p>
      The first step for face morphing is defining correspondences between facial features in the start and end images. In order to do this, I first used some scripts given in the last project to rotate and scale the images to similar sizes. Next, I needed to select a handful of points to create a triangulation. I created a tool that would let me pick points on an image and put them into a .json file. Then these points were averaged and a Delaunay triangulation was computed on the mean set of points. 

      Here I am morphing between two members of my favorite music group, Kim Lip and Go Won. 
      </p>
    </div>
    <span class="smol">hover to enlarge</span>
     <div class="row">
     <div class="col s12 m6">
     <p>
       Start source image (Kim Lip)
       </p>
       <img class="zoom" src="images/kimlip.jpg" width="300" height="320">
     </div>
     <div class="col s12 m6">
       <p>
        End source image (Go Won)
       </p>
       <img class="zoom" src="images/gowon.jpg" width="300" height="350">
     </div>
    </div>
    <div class="row">
        <div class="col s12 m6">
        <p>
          Points selected + mean triangulation
          </p>
          <img class="zoom" src="images/kimlip_points_avg.png" width="400" height="300">
        </div>
        <div class="col s12 m6">
          <p>
          Points selected + mean triangulation
          </p>
          <img class="zoom" src="images/gowon_points_avg.png" width="400" height="300">
        </div>
    </div>
    <div class="row">
      <h6 class="smallheader">Midway Image</h6>
      <p>
      The mid-way image between these two images is generated by warping both images into the mean triangulation. Doing this warp was kind of tricky: first, the area of each triangle had to be determined on the mean image and also the original image. Using an inverse affine transformation, the mean image triangle area could interpolate color values from the original image triangle area, creating the warp. 
      </p>
    </div>
    <div class="row">
      <div class="col s12">
      <p>
        Midway Image
        </p>
        <img class="zoom" src="images/midway_face.jpg" width="300" height="350">
      </div>
     </div>
     <div class="row">
      <h6 class="smallheader">The Morph Sequence</h6>
      <p>
      To complete the morph, I create an animation by creating a partial warp of the first image to the second that gets progressively larger for each frame. Eventually the first image is completely warped into the second, accompanying a cross-dissolve of the colors.  
      </p>
    </div>
    <div class="row">
        <div class="col s12">
        <p>
          Morph Video
          </p>
          <iframe width="560" height="315" src="https://www.youtube.com/embed/QZErrybtfEM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
       </div>
    <div class="row">
      <h6 class="smallheader">The "Mean Face" of a Population</h6>
      <p>
      In this part, I used a dataset of faces (Danish computer scientists) and computed the mean smiling face. This was done by averaging the set of points that labeled features for every face in the dataset, and then warping each face to that average shape. Then, averaging the warped faces into a single image. Here are some examples of faces being warped into the mean image.  
      </p>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <iframe width="400" height="300" src="https://www.youtube.com/embed/y4_ZDkwnoAE" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
      <div class="col s12 m6">
        <iframe width="400" height="300" src="https://www.youtube.com/embed/Bh_2ZDdXBUE" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
      <div class="col s12 m6">
        <iframe width="400" height="300" src="https://www.youtube.com/embed/nmZ3oeRuW8k" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>

    <div class="row">
      <div class="col s12 m6">
          <p>
          Average face
          </p>
          <img class="zoom" src="images/mean_face.jpg" width="400" height="300">
        </div>
        <div class="col s12 m6">
          <p>
          My face 
          </p>
          <img class="zoom" src="images/me.jpg" width="400" height="300">
        </div>
    </div>

    <div class="row">
      <div class="col s12 m6">
          <p>
          Average face warped into my geometry
          </p>
          <img class="zoom" src="images/warped_mean_face.jpg" width="400" height="300">
        </div>
        <div class="col s12 m6">
          <p>
          My face warped into the average face geometry
          </p>
          <img class="zoom" src="images/warped_me.jpg" width="400" height="300">
        </div>
    </div>

    <div class="row">
      <h6 class="smallheader">Caricatures: Extrapolating from the Mean</h6>
      <p>
      In this part, I produce a caricature of my face by extrapolating from the previous smiling mean. We can see that this caricature exaggerates the differences between the mean and my face, making my face even more rectangular and large. When extrapolating in the opposite direction, the caricature exaggerates the differences between the mean and my face, making it even rounder and smaller.
      </p>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <p>
        Caricature (alpha = 0.7)
        </p>
        <img class="zoom" src="images/caricature1_me.jpg" width="400" height="300">
        </div>
      <div class="col s12 m6">
        <p>
        Caricature (alpha = -1.7)
        </p>
        <img class="zoom" src="images/caricature2_me.jpg" width="400" height="300">
      </div>
    </div>

    <div class="row">
      <h6 class="smallheader">Bells and Whistles</h6>
      <p>
      For this part, I created a morph of my face into an average French woman face that I found online. The result is a bit scary since it warps my smiling face into a neutral face as well as shifting the overall geometry.
      </p>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <p>
        My source face
        </p>
        <img class="zoom" src="images/me_bw.jpg" width="300" height="400">
      </div>
      <div class="col s12 m6">
        <p>
        French average face
        </p>
        <img class="zoom" src="images/french_bw.jpg" width="300" height="400">
      </div>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <p>
        Warp shape only - My face warped into the french shape
        </p>
        <img class="zoom" src="images/warped_me_bw.jpg" width="300" height="400">
      </div>
      <div class="col s12 m6">
        <p>
        Warp appearance only - French face warped into my shape
        </p>
        <img class="zoom" src="images/warped_french_bw.jpg" width="300" height="400">
      </div>
    </div>

    <div class="row">
      <div class="col s12 m6">
        <p>
        Morph video
        </p>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/fQ6zKGje3xM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>

     <div class="row">
       <span class="smol">thanks for checking out my submission! :D</span>
       <!-- hehehe -->
       </div>
  </div>
</body>
